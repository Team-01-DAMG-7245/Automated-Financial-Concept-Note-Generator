argmax
ω
ωTμ −δ
2ωTΣω. Here ω is an N-element vector of asset weights, μ is an N-element vector of

expected asset returns, Σ is the N-by-N covariance matrix of asset returns, and δ is a positive risk
aversion parameter. Given δ , in the absence of constraints, a closed form solution to this problem is

ω = 1
δ Σ−1μ. Therefore, with a market portfolio, the implied expected return is π = δΣωmkt.

To compute an implied expected return, you need Σ, ωmkt, δ.

1) Find Σ.

Σ is calculated from historical asset returns.

Sigma = cov(assetRetn);

2) Find the market portfolio.

To find the market portfolio, regress against the DJI. The imposed constraints are fully invested and

long only: ∑
i = 1

n
ωi = 1, 0 ≤ωi, ∀i ∈{1, . . . , n}

numAssets = size(assetRetn,2);
LB = zeros(1,numAssets);
Aeq = ones(1,numAssets);
Beq = 1;
opts = optimoptions('lsqlin','Algorithm','interior-point', 'Display',"off");
wtsMarket = lsqlin(assetRetn, benchRetn, [], [], Aeq, Beq, LB, [], [], opts);

3) Find δ.

Multiply both sides of π = δΣωmkt with ωmkt
T
 to output δ = SharpeRatio
σm
. Here, the Benchmark is

assumed to be maximizing the Sharpe ratio and the corresponding value is used as market Sharpe
ratio. Alternatively, you can calibrate an annualized Sharpe ratio to be 0.5, which leads to shpr=0.5/
sqrt(252) [1 on page 4-229]. σm is the standard deviation of the market portfolio.

shpr = mean(benchRetn)/std(benchRetn);
delta = shpr/sqrt(wtsMarket'*Sigma*wtsMarket);

4) Compute the implied expected return.

Assuming that the market portfolio maximizes the Sharpe ratio, the implied return, without the
effects from constraints, is computed directly as π = δΣω.

PI = delta*Sigma*wtsMarket;
end

Appendix: Black-Litterman Model Under a Bayesian Framework

Assumptions and Views

Assume that the investment universe is composed of k assets and the vector of asset returns r is
modeled as a random variable, following a multivariate normal distribution r
N μ, Σ . Σ is the
covariance from historical asset returns. The unknown model parameter is the expected return μ.
From the perspective of Bayesian statistics, the Black-Litterman model attempts to estimate μ by

Black-Litterman Portfolio Optimization Using Financial Toolbox

4-227
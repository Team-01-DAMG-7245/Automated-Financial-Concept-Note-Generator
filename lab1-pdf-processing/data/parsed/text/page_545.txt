This figure shows how as the time period approaches the investment horizon, the CDF shifts to the
right and becomes steeper. This shift demonstrates that changes in the wealth level have a higher
impact toward the end of the investment horizon. For example, an increase of 100 to 110 wealth
points at t = 0 only increases the probability of success by 3%, while the same wealth increase at
t = 4 increases the probability of success by 7%.

Local Functions

function [Z,WPath,portPath,VPath] = DynamicPortSim(W0,WGrid,...
    pret,prsk,portIdx,V)
% Define time periods.
T = size(V,2)-1;

% Define standard normal random variables for the Brownian motion.
Z = randn(T,1);
Z = [Z;nan]; % No randomness at the final time period

% Find the wealth node index of the initial wealth.
tol = 1e-8; % Account for numerical inaccuracies
difference = WGrid-W0;
% Assign to wealth node j such that W_j <= W(0) < W_{j+1}
WNodeIdx = find(difference<=tol,1,'last');

% Run the simulation.
WPath = [W0; zeros(T,1)];
portPath = [portIdx(WNodeIdx,1); zeros(T,1)];
VPath = [V(WNodeIdx,1); zeros(T,1)];
for t = 1:T
    % Get the return and variance of optimal portfolio at time t.
    mu = pret(portIdx(WNodeIdx,t));
    sigma = prsk(portIdx(WNodeIdx,t));

% Compute the wealth at time t+1 following the Browninan motion.

Dynamic Portfolio Allocation in Goal-Based Wealth Management for Multiple Time Periods

4-377